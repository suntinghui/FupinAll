webpackJsonp([16],{LThR:function(e,t){},XUVx:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={data:function(){return{movie:{},list:[],player:{},collected:!1}},activated:function(){this.movie=JSON.parse(localStorage.getItem("video")),this.collected=!1,this.loadVideo(),this.getNewVideos()},methods:{getNewVideos:function(){var e=this;this.$axios.post(this.$config.videoList).then(function(t){console.log(t),e.list=t.data.data.latestVideoList})},chooseVideo:function(e){this.saveHistory(),this.collected=!1,this.movie=this.list[e],this.loadVideo()},loadVideo:function(){var e=this;this.player.dispose&&this.player.dispose(),this.player=new Aliplayer({id:"player",width:"100%",height:"4.28rem",autoplay:!0,preload:!1,rePlay:!1,playsinline:!0,useH5Prism:!0,cover:this.movie.imgPath,source:this.movie.osskey,controlBarVisibility:"always",x5_type:"h5",x5_fullscreen:"true",x5_video_position:"top",x5_orientation:"landscape"},function(t){t.on("play",function(){localStorage.getItem("login")||(t.pause(),e.$tip("请登录后观看！"))})}),this.movie.watchtime&&this.player.seek(this.movie.watchtime)},collect:function(){var e=this;0==this.collected?(this.collected=!0,this.$axios.post(this.$config.videoCollect,{vid:this.movie.id,createuser:JSON.parse(localStorage.getItem("login")).id}).then(function(t){"0000"==t.data.code&&e.$tip("收藏成功！")})):(this.collected=!1,this.$axios.post(this.$config.uncollectVideo,{vid:this.movie.id,createuser:JSON.parse(localStorage.getItem("login")).id}).then(function(t){console.log(t),"0000"==t.data.code&&e.$tip("取消收藏成功！")}))},back:function(){this.saveHistory(),this.$router.back(-1)},saveHistory:function(){var e=this.player.getCurrentTime();e>0&&localStorage.getItem("login")&&this.$axios.post(this.$config.addHistory,{vid:this.movie.id,createuser:JSON.parse(localStorage.getItem("login")).id,watchtime:e}).then(function(e){console.log(e)})},download:function(e){var t=navigator.userAgent,i=(navigator.appVersion,t.indexOf("Android")>-1||t.indexOf("Linux")>-1),o=!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);i&&window.WebViewJavascriptBridge.callHandler("downloadFile",{url:e},function(e){alert("success")}),o&&setupWebViewJavascriptBridge(function(t){t.callHandler("downloadFile",{url:e},function(e){alert("success")})})},setupWebViewJavascriptBridge:function(e){if(window.WebViewJavascriptBridge)return e(WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(e);window.WVJBCallbacks=[e];var t=document.createElement("iframe");t.style.display="none",t.src="https://__bridge_loaded__",document.documentElement.appendChild(t),setTimeout(function(){document.documentElement.removeChild(t)},0)},setFullScreen:function(){this.player.fullscreenService.requestFullScreen()}}},s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("a",{staticClass:"back",on:{click:e.back}}),e._v(" "),i("div",{staticClass:"prism-player",attrs:{id:"player"}}),e._v(" "),i("div",{on:{click:e.setFullScreen}},[e._v("测试全屏")]),e._v(" "),i("div",{staticClass:"msg"},[i("a",{staticClass:"download",on:{click:function(t){e.download(e.movie.osskey)}}}),e._v(" "),i("a",{staticClass:"collect",class:{active:e.collected},on:{click:e.collect}}),e._v(" "),i("h1",{staticClass:"text-ellipsis"},[e._v(e._s(e.movie.title))]),e._v(" "),i("p",[e._v(e._s(e.movie.classifyName))])]),e._v(" "),i("div",{staticClass:"scroll"},[i("ul",{staticClass:"list"},e._l(e.list,function(t,o){return t.id!=e.movie.id?i("li",{key:o,on:{click:function(t){e.chooseVideo(o)}}},[i("a",[i("div",{staticClass:"img-box"},[i("img",{attrs:{src:t.imgPath}}),e._v(" "),i("span",[e._v(e._s(t.totaltime))])]),e._v(" "),i("p",[e._v(e._s(t.title))])])]):e._e()}))])])},staticRenderFns:[]};var a=i("VU/8")(o,s,!1,function(e){i("LThR")},"data-v-0a71dbc8",null);t.default=a.exports}});
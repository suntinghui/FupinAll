webpackJsonp([14],{XUVx:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o={data:function(){return{movie:{},list:[],player:{},collected:!1}},activated:function(){this.movie=JSON.parse(localStorage.getItem("video")),this.collected=!1,this.loadVideo(),this.getNewVideos()},methods:{getNewVideos:function(){var t=this;this.$axios.post(this.$config.videoList).then(function(i){console.log(i),t.list=i.data.data.latestVideoList})},chooseVideo:function(t){this.saveHistory(),this.collected=!1,this.movie=this.list[t],this.loadVideo()},loadVideo:function(){var t=this;this.player.dispose&&this.player.dispose(),this.player=new Aliplayer({id:"player",width:"100%",height:"4.28rem",autoplay:!0,preload:!1,rePlay:!1,playsinline:!0,useH5Prism:!0,cover:this.movie.imgPath,source:this.movie.osskey,controlBarVisibility:"always",x5_type:"h5",x5_fullscreen:"true",x5_video_position:"top",x5_orientation:"landscape"},function(i){i.on("play",function(){localStorage.getItem("login")||(i.pause(),t.$tip("请登录后观看！"))})}),this.movie.watchtime&&this.player.seek(this.movie.watchtime)},collect:function(){var t=this;0==this.collected?(this.collected=!0,this.$axios.post(this.$config.videoCollect,{vid:this.movie.id,createuser:JSON.parse(localStorage.getItem("login")).id}).then(function(i){"0000"==i.data.code&&t.$tip("收藏成功！")})):(this.collected=!1,this.$axios.post(this.$config.uncollectVideo,{vid:this.movie.id,createuser:JSON.parse(localStorage.getItem("login")).id}).then(function(i){console.log(i),"0000"==i.data.code&&t.$tip("取消收藏成功！")}))},back:function(){this.saveHistory(),this.$router.back(-1)},saveHistory:function(){var t=this.player.getCurrentTime();t>0&&localStorage.getItem("login")&&this.$axios.post(this.$config.addHistory,{vid:this.movie.id,createuser:JSON.parse(localStorage.getItem("login")).id,watchtime:t}).then(function(t){console.log(t)})},download:function(t){var i=navigator.userAgent,e=(navigator.appVersion,i.indexOf("Android")>-1||i.indexOf("Linux")>-1),o=!!i.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);e&&window.WebViewJavascriptBridge.callHandler("downloadFile",{url:t},function(t){alert("success")}),o&&setupWebViewJavascriptBridge(function(i){i.callHandler("downloadFile",{url:t},function(t){alert("success")})})},setupWebViewJavascriptBridge:function(t){if(window.WebViewJavascriptBridge)return t(WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(t);window.WVJBCallbacks=[t];var i=document.createElement("iframe");i.style.display="none",i.src="https://__bridge_loaded__",document.documentElement.appendChild(i),setTimeout(function(){document.documentElement.removeChild(i)},0)}}},s={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("a",{staticClass:"back",on:{click:t.back}}),t._v(" "),e("div",{staticClass:"prism-player",attrs:{id:"player"}}),t._v(" "),e("div",{staticClass:"msg"},[e("a",{staticClass:"download",on:{click:function(i){t.download(t.movie.osskey)}}}),t._v(" "),e("a",{staticClass:"collect",class:{active:t.collected},on:{click:t.collect}}),t._v(" "),e("h1",{staticClass:"text-ellipsis"},[t._v(t._s(t.movie.title))]),t._v(" "),e("p",[t._v(t._s(t.movie.classifyName))])]),t._v(" "),e("div",{staticClass:"scroll"},[e("ul",{staticClass:"list"},t._l(t.list,function(i,o){return i.id!=t.movie.id?e("li",{key:o,on:{click:function(i){t.chooseVideo(o)}}},[e("a",[e("div",{staticClass:"img-box"},[e("img",{attrs:{src:i.imgPath}}),t._v(" "),e("span",[t._v(t._s(i.totaltime))])]),t._v(" "),e("p",[t._v(t._s(i.title))])])]):t._e()}))])])},staticRenderFns:[]};var a=e("VU/8")(o,s,!1,function(t){e("ZSjq")},"data-v-2d592cc9",null);i.default=a.exports},ZSjq:function(t,i){}});
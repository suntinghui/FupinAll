webpackJsonp([14],{XUVx:function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=t("BO1k"),s=t.n(o),a=t("mvHQ"),l=t.n(a),c={data:function(){return{movie:{},list:[],player:{},collected:!1}},activated:function(){this.movie=JSON.parse(localStorage.getItem("video")),this.collected=!1,this.loadVideo(),this.getNewVideos(),console.log(this.movie)},methods:{getNewVideos:function(){var e=this;this.$axios.post(this.$config.videoList,{}).then(function(i){console.log(i);var t=e.movie.osskey.lastIndexOf("."),o=e.movie.osskey.substr(t+1);e.list="mp3"==o?i.data.data.latestAudioList:i.data.data.latestVideoList})},chooseVideo:function(e){this.saveHistory(),this.collected=!1,this.movie=this.list[e],this.loadVideo()},loadVideo:function(){var e=this;this.player.dispose&&this.player.dispose(),this.player=new Aliplayer({id:"player",width:"100%",height:"4.28rem",autoplay:!0,rePlay:!1,cover:this.movie.imgPath,source:this.movie.osskey,controlBarVisibility:"always"},function(i){console.log("加载成功"),i.on("play",function(){if(!localStorage.getItem("login")){if(!localStorage.getItem("freeTime")){var t=[];return t.push(e.movie.id),void localStorage.setItem("freeTime",l()(t))}var o=JSON.parse(localStorage.getItem("freeTime")),a=!0,c=!1,n=void 0;try{for(var r,d=s()(o);!(a=(r=d.next()).done);a=!0){if(r.value==e.movie.id)return}}catch(e){c=!0,n=e}finally{try{!a&&d.return&&d.return()}finally{if(c)throw n}}if(o.length<5)return console.log(o,e.movie.id),o.push(e.movie.id),void localStorage.setItem("freeTime",l()(o));i.pause(),e.$tip("请登录后观看！")}})}),this.movie.watchtime&&this.player.seek(this.movie.watchtime)},collect:function(){var e=this;0==this.collected?(this.collected=!0,this.$axios.post(this.$config.videoCollect,{vid:this.movie.id,createuser:JSON.parse(localStorage.getItem("login")).id}).then(function(i){"0000"==i.data.code&&e.$tip("收藏成功！")})):(this.collected=!1,this.$axios.post(this.$config.uncollectVideo,{vid:this.movie.id,createuser:JSON.parse(localStorage.getItem("login")).id}).then(function(i){console.log(i),"0000"==i.data.code&&e.$tip("取消收藏成功！")}))},back:function(){this.saveHistory(),this.$router.back(-1)},saveHistory:function(){var e=this.player.getCurrentTime();e>0&&localStorage.getItem("login")&&this.$axios.post(this.$config.addHistory,{vid:this.movie.id,createuser:JSON.parse(localStorage.getItem("login")).id,watchtime:e}).then(function(e){console.log(e)})},download:function(){var e=navigator.userAgent,i=(navigator.appVersion,e.indexOf("Android")>-1||e.indexOf("Linux")>-1),t=!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);i&&window.WebViewJavascriptBridge.callHandler("downloadFile",{url:this.movie.osskey,imgUrl:this.movie.imgPath,videoId:this.movie.id,title:this.movie.title},function(e){}),t&&this.setupWebViewJavascriptBridge(function(e){e.callHandler("downloadFile",{url:this.movie.osskey,imgUrl:this.movie.imgPath,videoId:this.movie.id,title:this.movie.title},function(e){})})},setupWebViewJavascriptBridge:function(e){if(window.WebViewJavascriptBridge)return e(WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(e);window.WVJBCallbacks=[e];var i=document.createElement("iframe");i.style.display="none",i.src="https://__bridge_loaded__",document.documentElement.appendChild(i),setTimeout(function(){document.documentElement.removeChild(i)},0)}}},n={render:function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",[t("a",{staticClass:"back",on:{click:e.back}}),e._v(" "),t("div",{staticClass:"prism-player",attrs:{id:"player"}}),e._v(" "),t("div",{staticClass:"msg"},[t("a",{staticClass:"download",on:{click:e.download}}),e._v(" "),t("a",{staticClass:"collect",class:{active:e.collected},on:{click:e.collect}}),e._v(" "),t("h1",{staticClass:"text-ellipsis"},[e._v(e._s(e.movie.title))]),e._v(" "),t("p",[e._v(e._s(e.movie.classifyName))])]),e._v(" "),t("div",{staticClass:"scroll"},[t("ul",{staticClass:"list"},e._l(e.list,function(i,o){return i.id!=e.movie.id?t("li",{key:o,on:{click:function(i){e.chooseVideo(o)}}},[t("a",[t("div",{staticClass:"img-box"},[t("img",{attrs:{src:i.imgPath}}),e._v(" "),t("span",[e._v(e._s(i.totaltime))])]),e._v(" "),t("p",[e._v(e._s(i.title))])])]):e._e()}))])])},staticRenderFns:[]};var r=t("VU/8")(c,n,!1,function(e){t("zKYV")},"data-v-48c5077e",null);i.default=r.exports},zKYV:function(e,i){}});